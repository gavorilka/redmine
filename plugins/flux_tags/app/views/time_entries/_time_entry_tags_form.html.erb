 <% if User.current.admin? || User.current.allowed_to?(:manage_time_entries_tags, nil , global: true) %>
<p><%= form.text_field :tag_list, :size => 20, :value => time_entry.tag_list.to_s %></p>

<script type="text/javascript">
  $(document).ready(function() {
    $('#time_entry_tag_list').tagit({
      tagSource: function(search, showChoices) {
        var that = this;
        var projectId = '<%= @time_entry.project_id.present? ? @time_entry.project_id : "null" %>'; 
        var url;
        if (projectId !== "null") {
          url = '<%= j auto_complete_time_entry_tags_path(:project_id => @time_entry.project_id) %>';
        } else {
          url = '<%= j auto_complete_time_entry_tags_path %>';
        }
        $.ajax({
          url: url,
          type: "GET",
          dataType: 'json',
          data: { q: search.term },
          success: function(choices) {
            if (!choices || choices.length === 0) {
              console.warn("No tags found for:", search.term);
              return;
            }
            showChoices(that._subtractArray($.parseJSON(choices), that.assignedTags()));
          }
        });
      },
      allowSpaces: true,
      placeholderText: '<%= j(I18n.t("add_tags_placeholder")) %>',
      caseSensitive: true,
      autocomplete: true,
      removeConfirmation: true,
      showAutocompleteOnFocus: true,
      tagLimit: 30,
    });
  });
</script>
<style>
  html[lang="ar"] li.tagit-new {
  float: none !important;
}
html[lang="ar"] li.tagit-new .ui-widget-content.ui-autocomplete-input{
  text-align: start !important;
  padding-right: 10px !important;

}
html[lang="ar"] .tagit-choice.ui-widget-content.ui-state-default.ui-corner-all.tagit-choice-editable{
  float: right !important;
}
ul.tagit li.tagit-choice .tagit-close {
    cursor: pointer;
    position: absolute;
    right: .4em;
    top: 50%;
    margin-top: -8.5px !important;
    line-height: 17px;
  }
</style>
<% end %>